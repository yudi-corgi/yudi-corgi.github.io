import{e as X,n as Z,p as O,q as ee,P as se,t as te,s as ae,v as A,f as H,x as t,y as re,j as T,z as le,R as F,A as oe,B as ie,C as ue,D as ne,E as ce,F as L,G as P,H as pe,I as ve,J as he,h as de,K as me,L as ge,M as ye,N as I,O as _e,Q as B}from"./app-BYb6nXW1.js";const fe=["/","/intro.html","/posts/dev_experience/enum_convert.html","/posts/distribute/distributed_transaction.html","/posts/distribute/jenkins_pipeline.html","/posts/distribute/tcp.html","/posts/java/java-string.html","/posts/java/jdk7-HashMap.html","/posts/java/jdk8-HashMap.html","/posts/java/jvm-class-loading-mechanism.html","/posts/java/jvm-memory-model.html","/posts/reprint/how_does_b-tree_make_your_queries_fast.html","/posts/reprint/is_it_time_to_ditch_mysql_and_postgresql_for_sqlite.html","/posts/reprint/sharded_does_not_imply_distributed.html","/posts/reprint/webSockets_vs_server-sent-events_vs_long-polling_vs_webrtc_vs_webtransport.html","/posts/reprint/why_is_oauth_still_hard_in_2025.html","/posts/framework/cache/J2Cache.html","/posts/framework/spring/spring_cloud_stream_one.html","/posts/framework/spring/spring_cloud_stream_three.html","/posts/framework/spring/spring_cloud_stream_two.html","/posts/framework/spring/spring_transaction_synchronization.html","/posts/framework/spring/spring_websocket_one.html","/posts/framework/spring/spring_websocket_two.html","/404.html","/posts/dev_experience/","/posts/","/posts/distribute/","/posts/java/","/posts/reprint/","/posts/framework/cache/","/posts/framework/","/posts/framework/spring/","/category/","/category/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/","/category/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/","/category/devops/","/category/tcp/","/category/%E7%BD%91%E7%BB%9C/","/category/java/","/category/%E6%9D%82%E8%B0%88/","/category/cache/","/category/spring-cloud/","/category/mq/","/category/spring/","/tag/","/tag/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/","/tag/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/","/tag/jenkins/","/tag/devops/","/tag/tcpip/","/tag/%E7%BD%91%E7%BB%9C/","/tag/java/","/tag/string/","/tag/hashmap/","/tag/%E9%9B%86%E5%90%88/","/tag/jvm/","/tag/%E6%9D%82%E8%B0%88/","/tag/cache/","/tag/redis/","/tag/spring-cloud/","/tag/mq/","/tag/spring/","/tag/transaction/","/tag/spring-boot/","/tag/websocket/","/article/","/star/","/timeline/"],ke="SEARCH_PRO_QUERY_HISTORY",g=I(ke,[]),we=()=>{const{queryHistoryCount:r}=B;return{enabled:r>0,queryHistory:g,addQueryHistory:i=>{g.value=Array.from(new Set([i,...g.value.slice(0,r-1)]))},removeQueryHistory:i=>{g.value=[...g.value.slice(0,i),...g.value.slice(i+1)]}}},Q=r=>fe[r.id]+("anchor"in r?`#${r.anchor}`:""),Ee="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:$}=B,y=I(Ee,[]),He=()=>({enabled:$>0,resultHistory:y,addResultHistory:l=>{{const i={link:Q(l),display:l.display};"header"in l&&(i.header=l.header),y.value=[i,...y.value.slice(0,$-1)]}},removeResultHistory:l=>{y.value=[...y.value.slice(0,l),...y.value.slice(l+1)]}}),Be=r=>{const l=pe(),i=O(),j=ve(),u=A(0),_=H(()=>u.value>0),v=he([]);return de(()=>{const{search:q,terminate:h}=me(),f=ge(m=>{const k=m.join(" "),{searchFilter:d=a=>a,splitWord:x,suggestionsFilter:o,...n}=l.value;k?(u.value+=1,q(m.join(" "),i.value,n).then(a=>d(a,k,i.value,j.value)).then(a=>{u.value-=1,v.value=a}).catch(a=>{console.warn(a),u.value-=1,u.value||(v.value=[])})):v.value=[]},B.searchDelay-B.suggestDelay);T([r,i],([m])=>f(m),{immediate:!0}),ye(()=>{h()})}),{isSearching:_,results:v}};var qe=X({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(r,{emit:l}){const i=Z(),j=O(),u=ee(se),{addQueryHistory:_,queryHistory:v,removeQueryHistory:q}=we(),{resultHistory:h,addResultHistory:f,removeResultHistory:m}=He(),k=te(r,"queries"),{results:d,isSearching:x}=Be(k),o=ae({isQuery:!0,index:0}),n=A(0),a=A(0),D=H(()=>v.value.length>0||h.value.length>0),R=H(()=>d.value.length>0),b=H(()=>d.value[n.value]||null),M=()=>{const{isQuery:e,index:s}=o;s===0?(o.isQuery=!e,o.index=e?h.value.length-1:v.value.length-1):o.index=s-1},U=()=>{const{isQuery:e,index:s}=o;s===(e?v.value.length-1:h.value.length-1)?(o.isQuery=!e,o.index=0):o.index=s+1},Y=()=>{n.value=n.value>0?n.value-1:d.value.length-1,a.value=b.value.contents.length-1},z=()=>{n.value=n.value<d.value.length-1?n.value+1:0,a.value=0},J=()=>{a.value<b.value.contents.length-1?a.value+=1:z()},G=()=>{a.value>0?a.value-=1:Y()},C=e=>e.map(s=>_e(s)?s:t(s[0],s[1])),K=e=>{if(e.type==="customField"){const s=ne[e.index]||"$content",[c,E=""]=ce(s)?s[j.value].split("$content"):s.split("$content");return e.display.map(p=>t("div",C([c,...p,E])))}return e.display.map(s=>t("div",C(s)))},w=()=>{n.value=0,a.value=0,l("updateQuery",""),l("close")},N=()=>t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},u.value.queryHistory),v.value.map((e,s)=>t("div",{class:["search-pro-result-item",{active:o.isQuery&&o.index===s}],onClick:()=>{l("updateQuery",e)}},[t(L,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},e),t("button",{class:"search-pro-remove-icon",innerHTML:P,onClick:c=>{c.preventDefault(),c.stopPropagation(),q(s)}})]))])),V=()=>t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},u.value.resultHistory),h.value.map((e,s)=>t(F,{to:e.link,class:["search-pro-result-item",{active:!o.isQuery&&o.index===s}],onClick:()=>{w()}},()=>[t(L,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(c=>C(c)).flat())]),t("button",{class:"search-pro-remove-icon",innerHTML:P,onClick:c=>{c.preventDefault(),c.stopPropagation(),m(s)}})]))]));return re("keydown",e=>{if(r.isFocusing){if(R.value){if(e.key==="ArrowUp")G();else if(e.key==="ArrowDown")J();else if(e.key==="Enter"){const s=b.value.contents[a.value];_(r.queries.join(" ")),f(s),i.push(Q(s)),w()}}else if(e.key==="ArrowUp")M();else if(e.key==="ArrowDown")U();else if(e.key==="Enter"){const{index:s}=o;o.isQuery?(l("updateQuery",v.value[s]),e.preventDefault()):(i.push(h.value[s].link),w())}}}),T([n,a],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result-wrapper",{empty:r.queries.length?!R.value:!D.value}],id:"search-pro-results"},r.queries.length?x.value?t(le,{hint:u.value.searching}):R.value?t("ul",{class:"search-pro-result-list"},d.value.map(({title:e,contents:s},c)=>{const E=n.value===c;return t("li",{class:["search-pro-result-list-item",{active:E}]},[t("div",{class:"search-pro-result-title"},e||u.value.defaultTitle),s.map((p,W)=>{const S=E&&a.value===W;return t(F,{to:Q(p),class:["search-pro-result-item",{active:S,"aria-selected":S}],onClick:()=>{_(r.queries.join(" ")),f(p),w()}},()=>[p.type==="text"?null:t(p.type==="title"?oe:p.type==="heading"?ie:ue,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[p.type==="text"&&p.header?t("div",{class:"content-header"},p.header):null,t("div",K(p))])])})])})):u.value.emptyResult:D.value?[N(),V()]:u.value.emptyHistory)}});export{qe as default};
